# StockWiz - Diagrama de Infraestructura AWS

## Arquitectura Visual ASCII

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            🌐 INTERNET / USUARIOS                                │
└──────────────────────────────────────┬──────────────────────────────────────────┘
                                       │
                                       ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  AWS CLOUD - REGION: us-east-1                                                   │
│                                                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  VPC (10.0.0.0/16)                                                       │    │
│  │                                                                           │    │
│  │  ┌──────────────────────────────────────────────────────────────────┐   │    │
│  │  │  PUBLIC SUBNETS                                                   │   │    │
│  │  │  ┌─────────────────────┐         ┌─────────────────────┐        │   │    │
│  │  │  │  AZ: us-east-1a     │         │  AZ: us-east-1b     │        │   │    │
│  │  │  │  10.0.1.0/24        │         │  10.0.2.0/24        │        │   │    │
│  │  │  │                     │         │                     │        │   │    │
│  │  │  │  ┌──────────────┐  │         │  ┌──────────────┐   │        │   │    │
│  │  │  │  │     ALB      │◄─┼─────────┼─►│  ALB Standby │   │        │   │    │
│  │  │  │  │   dev-alb    │  │         │  │              │   │        │   │    │
│  │  │  │  │  Port: 80    │  │         │  │              │   │        │   │    │
│  │  │  │  └──────┬───────┘  │         │  └──────────────┘   │        │   │    │
│  │  │  └─────────┼──────────┘         └─────────────────────┘        │   │    │
│  │  │            │  IGW                                               │   │    │
│  │  └────────────┼───────────────────────────────────────────────────┘   │    │
│  │               │                                                         │    │
│  │               ▼                                                         │    │
│  │  ┌──────────────────────────────────────────────────────────────────┐ │    │
│  │  │  PRIVATE SUBNETS                                                  │ │    │
│  │  │                                                                    │ │    │
│  │  │  ┌─────────────────────┐         ┌─────────────────────┐        │ │    │
│  │  │  │  AZ: us-east-1a     │         │  AZ: us-east-1b     │        │ │    │
│  │  │  │  10.0.11.0/24       │         │  10.0.12.0/24       │        │ │    │
│  │  │  │                     │         │                     │        │ │    │
│  │  │  │  ┌──────────────┐  │         │  ┌──────────────┐   │        │ │    │
│  │  │  │  │  ECS TASK    │  │         │  │ ECS STANDBY  │   │        │ │    │
│  │  │  │  │              │  │         │  │              │   │        │ │    │
│  │  │  │  └──────────────┘  │         │  └──────────────┘   │        │ │    │
│  │  │  └─────────────────────┘         └─────────────────────┘        │ │    │
│  │  │                                                                    │ │    │
│  │  │  NAT Gateway ──────────────────────────────────┐                 │ │    │
│  │  └───────────────────────────────────────────────┼─────────────────┘ │    │
│  └────────────────────────────────────────────────────┼───────────────────┘    │
│                                                        │                         │
└────────────────────────────────────────────────────────┼─────────────────────────┘
                                                         │
                                                    (Outbound)

════════════════════════════════════════════════════════════════════════════════

                        ECS TASK DEFINITION: dev-stockwiz
                        ─────────────────────────────────
                        CPU: 2048 (2 vCPU) | Memory: 4096 MB (4 GB)

┌───────────────────────────────────────────────────────────────────────────────┐
│                                                                                │
│    ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐    │
│    │   POSTGRES      │      │     REDIS       │      │  API GATEWAY    │    │
│    │   Container     │      │   Container     │      │   Container     │    │
│    │                 │      │                 │      │                 │    │
│    │   Port: 5432    │◄─────┤   Port: 6379    │◄─────┤   Port: 8000    │    │
│    │   DB: microserv │      │   Cache Layer   │      │   Go + Chi      │    │
│    │   User: admin   │      │   redis:7-alpine│      │   Routes:       │    │
│    │                 │      │                 │      │   /health       │    │
│    └─────────────────┘      └─────────────────┘      │   /api/*        │    │
│            ▲                         ▲                └────────┬────────┘    │
│            │                         │                         │             │
│            │                         │                         ▼             │
│    ┌───────┴────────┐       ┌────────┴────────┐                             │
│    │                │       │                 │                             │
│    │ ┌──────────────┴─────┐ │ ┌───────────────┴────┐                       │
│    │ │  PRODUCT SERVICE   │ │ │ INVENTORY SERVICE  │                       │
│    │ │    Container       │ │ │    Container       │                       │
│    │ │                    │ │ │                    │                       │
│    │ │   Port: 8001       │ │ │   Port: 8002       │                       │
│    │ │   Python/FastAPI   │ │ │   Go + Chi         │                       │
│    │ │   Products CRUD    │ │ │   Inventory CRUD   │                       │
│    │ └────────────────────┘ │ └────────────────────┘                       │
│    └────────────────────────┘                                               │
│                                                                               │
└───────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════

                            SERVICIOS COMPLEMENTARIOS
                            ──────────────────────────

┌────────────────────────┐    ┌────────────────────────┐    ┌──────────────────┐
│  ECR REPOSITORIES      │    │  CLOUDWATCH            │    │  GITHUB ACTIONS  │
│  ──────────────────    │    │  ───────────           │    │  ──────────────  │
│                        │    │                        │    │                  │
│  • dev-stockwiz-       │    │  📝 Logs Group:        │    │  ⚙️  Pipeline:   │
│    api-gateway         │    │     /ecs/dev           │    │     dev-pipeline │
│                        │    │                        │    │                  │
│  • dev-stockwiz-       │    │  🚨 Alarms:            │    │  🔍 SonarCloud   │
│    product-service     │    │     - High CPU > 80%   │    │     Analysis     │
│                        │    │     - High Mem > 80%   │    │                  │
│  • dev-stockwiz-       │    │     - 5xx Errors > 10  │    │  📊 Coverage:    │
│    inventory-service   │    │                        │    │     Python: 38%  │
│                        │    │  📧 SNS Alerts:        │    │     Go API: 54%  │
│  • dev-stockwiz-       │    │     yokadance@         │    │     Go Inv: 5%   │
│    postgres            │    │     gmail.com          │    │                  │
└────────────────────────┘    └────────────────────────┘    └──────────────────┘

════════════════════════════════════════════════════════════════════════════════

                               FLUJO DE REQUESTS
                               ─────────────────

    Usuario
      │
      ▼
    Internet Gateway
      │
      ▼
    ALB (dev-alb)
      │
      ├──► /health ──────────────────────────► API Gateway :8000
      │                                              │
      ├──► /api/products/* ─────────────────────────┼──► Product Service :8001
      │                                              │         │
      ├──► /api/inventory/* ────────────────────────┼──► Inventory Service :8002
                                                     │         │
                                                     ▼         ▼
                                             ┌─────────────────────┐
                                             │   PostgreSQL :5432  │
                                             │   Redis :6379       │
                                             └─────────────────────┘

════════════════════════════════════════════════════════════════════════════════

                            SECURITY GROUPS
                            ───────────────

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│  ALB Security Group                       ECS Tasks Security Group          │
│  ──────────────────                       ──────────────────────            │
│                                                                              │
│  Inbound:                                 Inbound:                          │
│    • Port 80 (HTTP) ← 0.0.0.0/0            • Port 8000-8002 ← ALB SG       │
│    • Port 443 (HTTPS) ← 0.0.0.0/0          • Port 5432 (internal)          │
│                                             • Port 6379 (internal)          │
│  Outbound:                                                                  │
│    • All Traffic                          Outbound:                         │
│                                             • All Traffic                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════

                         ENDPOINTS DISPONIBLES
                         ─────────────────────

Base URL: http://dev-alb-XXXXXXXXX.us-east-1.elb.amazonaws.com

┌────────────────────────────────────────────────────────────────────────┐
│  HEALTH                                                                 │
│  ──────                                                                 │
│  GET  /health                              → API Gateway Health         │
└────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────┐
│  PRODUCTS API                                                           │
│  ────────────                                                           │
│  GET     /api/products                     → List all products          │
│  POST    /api/products                     → Create product             │
│  GET     /api/products/{id}                → Get product by ID          │
│  PUT     /api/products/{id}                → Update product             │
│  DELETE  /api/products/{id}                → Delete product             │
└────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────┐
│  INVENTORY API                                                          │
│  ─────────────                                                          │
│  GET     /api/inventory                    → List all inventory         │
│  POST    /api/inventory                    → Create inventory           │
│  GET     /api/inventory/{id}               → Get inventory by ID        │
│  PUT     /api/inventory/{id}               → Update inventory           │
│  DELETE  /api/inventory/{id}               → Delete inventory           │
└────────────────────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════════════════════════

                         COSTOS ESTIMADOS MENSUALES
                         ──────────────────────────

┌──────────────────────────────────────┬─────────────────────┐
│  Recurso                             │  Costo Aprox. (USD) │
├──────────────────────────────────────┼─────────────────────┤
│  ECS Fargate (1 task, 2vCPU, 4GB)   │      $30 - $40      │
│  Application Load Balancer           │      $20 - $25      │
│  NAT Gateway                         │      $30 - $35      │
│  CloudWatch Logs (7 días retention)  │       $5 - $10      │
│  ECR Storage                         │       $1 - $5       │
│  Data Transfer                       │      $10 - $20      │
├──────────────────────────────────────┼─────────────────────┤
│  TOTAL                               │    $96 - $135/mes   │
└──────────────────────────────────────┴─────────────────────┘

════════════════════════════════════════════════════════════════════════════════
